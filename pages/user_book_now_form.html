<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../assets/CSS/universe.css">
    <link rel="stylesheet" href="../assets/CSS/booking_list.css">
    <title>booking page</title>
</head>

<body>

    <!-- maincontainer is started -->
    <div class="container">
        <div class="list-of-customer">
            <div class="a-form bookingpage">
                <form id="bookingform">

                    <label>Design name :</label>
                    <input id="designname" type="text" placeholder="design name" />
                    <br /><br />
                    <label>Design url :</label>
                    <input id="designurl" type="text" placeholder="url" />
                    <br /><br />
                    <label>Expected amount:</label>
                    <input id="amount" type="number" />
                    <br /><br />
                    <label>Expected time period:</label>
                    <input id="time" type="number" />
                    <br /><br />
                    <label for="textarea">Message :</label>
                    <textarea id="messagetextarea" name="textarea" rows="2" cols="40">
                    </textarea>
                    <br />
                    <div class="both-btn">
                        <button type="submit">submit</button>
                    </div>
                </form>
            </div>


        </div>

    </div>



    <script>

        const bookingform = document.getElementById("bookingform");
        bookingform.addEventListener("submit", function (e) {
            e.preventDefault();

            const allarc = JSON.parse(localStorage.getItem("personArchitect"));
            console.log(allarc)

            let urlSearch = window.location.search;
            console.log(urlSearch);
            let url_params = new URLSearchParams(urlSearch);
            console.log(url_params);
            // console.log(URLSearchParams)
            let get_id = url_params.get("id");
            console.log(get_id);

            let oneArc = allarc.find(function (event) {
                let arcId = event["arcId"];
                if (get_id == arcId) {
                    return true;
                }
            });
            console.log(oneArc);


            const thisuser = JSON.parse(localStorage.getItem("this_user"));
            const alluser = JSON.parse(localStorage.getItem("register"));


            let ownuser = alluser.find(function (event) {
                let userEmail = event["userEmail"];
                if (thisuser == userEmail) {
                    return true;
                }
            });
            console.log(ownuser);


            const bookdesignname = document.getElementById("designname").value.trim();
            const bookdesignurl = document.getElementById("designurl").value.trim();
            const bookamount = document.getElementById("amount").value.trim();
            const booktime = document.getElementById("time").value.trim();
            const bookmessage = document.getElementById("messagetextarea").value.trim();
            const bookid = Date.now();


            let bookuserdetail = {
                userId: ownuser.userId,
                userName: ownuser.userName,
                userEmail: ownuser.userEmail,
                userNumber: ownuser.userNumber,
                bookid: bookid,
                bookdesignname: bookdesignname,
                bookdesignurl: bookdesignurl,
                bookamount: bookamount,
                booktime: booktime,
                bookmessage: bookmessage,
            }

            oneArc.booked.push(bookuserdetail)
            console.log(bookuserdetail);
            let onearcindex = allarc.indexOf(oneArc);
            console.log(onearcindex);
            allarc[onearcindex] = oneArc;
            console.log(oneArc)
            const str = JSON.stringify(allarc);
            confirm("Make sure the given details should be correct we give this details to the Architect whom you select");
            window.localStorage.setItem("personArchitect", str);

        })

    </script>
</body>

</html>